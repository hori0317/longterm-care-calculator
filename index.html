 (cd "$(git rev-parse --show-toplevel)" && git apply --3way <<'EOF' 
diff --git a/contact.html b/contact.html
index 7d079321ecba77f088d46c36b12b2277450e3ee0..f8b50b40fada2c274ec935ff9a904be00c47b570 100644
--- a/contact.html
+++ b/contact.html
@@ -1,196 +1,335 @@
 <!DOCTYPE html>
 <html lang="zh-Hant">
 <head>
   <meta charset="UTF-8" />
   <meta name="viewport" content="width=device-width,initial-scale=1" />
   <title>PDF 支數自動統計（AA 金額換算｜含 OCR）</title>
   <meta name="description" content="上傳 PDF，自動統計 BA/AA/GA/SC 支數。AA 依金額÷單價換算（量化為 0.5 倍數）；若為掃描影像自動啟用 OCR（chi_tra+eng）。">
+  <link rel="icon" type="image/x-icon" href="YORU.ico" />
+  <link rel="stylesheet" href="style.css" />
+  <link rel="stylesheet" href="nav-fix.css" />
+  <script src="nav-fix.js" defer></script>
 
   <style>
-    :root{--bg:#f6f8fb;--panel:#fff;--text:#0b1220;--muted:#5b6b81;--accent:#2667ff;--br:16px}
-    html,body{margin:0;background:var(--bg);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial}
-    .wrap{max-width:1120px;margin:0 auto;padding:20px 16px 40px}
-    .card{background:var(--panel);border:1px solid #e1e6ef;border-radius:var(--br);box-shadow:0 4px 14px rgba(20,40,80,.06);padding:16px;margin:12px 0}
-    h1{font-size:1.5rem;margin:.4rem 0}
-    .muted{color:var(--muted)}
-    .row{display:grid;gap:12px}
-    @media(min-width:920px){.row{grid-template-columns:1.15fr .85fr}}
-    .drop{border:2px dashed #c7d3ee;border-radius:12px;padding:18px;text-align:center;cursor:pointer;background:#f9fbff}
-    .drop:hover{background:#eef4ff}
-    input[type=file]{display:none}
-    .btn{appearance:none;border:1px solid #c7d3ee;background:#f3f6ff;color:#102a56;padding:10px 14px;border-radius:12px;cursor:pointer}
-    .btn:disabled{opacity:.5;cursor:not-allowed}
-    table{width:100%;border-collapse:collapse;border-radius:12px;overflow:hidden}
-    thead th{background:#eef3ff;color:#102a56;text-align:left;padding:10px;border-bottom:1px solid #d8e2ff}
-    tbody td{padding:10px;border-bottom:1px solid #edf1f7}
-    tbody tr:hover{background:#f5f8ff}
-    .pill{display:inline-block;padding:2px 8px;border-radius:999px;background:#eef4ff;border:1px solid #dbe6ff;font-size:.85rem;color:#102a56}
-    .right{text-align:right}
-    .small{font-size:.86rem}
-    .grid2{display:grid;gap:12px}
-    @media(min-width:720px){.grid2{grid-template-columns:1fr 1fr}}
-    .mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace}
-    #debug{margin-top:12px;padding:10px;border:1px dashed #c7d3ee;background:#f9fbff;border-radius:8px;font-size:12px;white-space:pre-wrap;color:#102a56}
-    .progress{height:10px;background:#eef3ff;border-radius:999px;overflow:hidden}
-    .bar{height:100%;width:0%;background:#2667ff;transition:width .2s}
-    .hint{display:inline-block;margin-left:8px;color:#845400}
+    :root{
+      --wm-text: "@hori版權所有";
+      --wm-size: 36px;
+      --wm-angle: -25deg;
+      --wm-alpha: 0.05;
+      --wm-shift: 120px;
+    }
+    .watermark{
+      position:fixed; inset:0; pointer-events:none; z-index:9999; overflow:hidden;
+    }
+    .wm-item{
+      position:absolute; font-weight:700; font-size:var(--wm-size);
+      color:rgba(0,0,0,var(--wm-alpha)); transform:rotate(var(--wm-angle));
+      white-space:nowrap; user-select:none; will-change:transform;
+      animation:wm-sway var(--dur,12s) ease-in-out infinite alternate;
+    }
+    @keyframes wm-sway{
+      0%{ transform:translateX(0) rotate(var(--wm-angle)); }
+      100%{ transform:translateX(var(--wm-shift)) rotate(var(--wm-angle)); }
+    }
+    @media print{ .watermark{ opacity:0.08; } }
+
+    .contact-container{ display:flex; flex-direction:column; gap:16px; padding-bottom:40px; }
+    .contact-intro .tag{ display:inline-flex; align-items:center; gap:6px; padding:6px 12px; border-radius:999px; border:1px solid var(--line); background:#fff; font-weight:700; color:#4a4428; }
+    .contact-intro .tag-list{ margin:14px 0 0; display:flex; flex-wrap:wrap; gap:10px; }
+    .contact-intro .tag-list .tag{
+      display:inline-flex; align-items:center; gap:6px;
+      padding:6px 12px; border-radius:999px; border:1px solid var(--line);
+      background:#fff; font-weight:700; color:#4a4428;
+    }
+
+    .contact-grid{ display:grid; gap:16px; }
+    @media (min-width: 980px){ .contact-grid{ grid-template-columns: 1.1fr 0.9fr; align-items:start; } }
+
+    .contact-drop{
+      display:block; border:2px dashed #d6cfae; border-radius:14px;
+      padding:24px 18px; text-align:center; cursor:pointer;
+      background:#fffef9; transition:background 0.2s ease, border-color 0.2s ease;
+    }
+    .contact-drop:hover{ background:#fff9ec; border-color:#f1d48f; }
+    input[type="file"]#file{ display:none; }
+
+    .contact-actions{ display:flex; flex-wrap:wrap; gap:10px; margin-top:12px; }
+    .contact-actions .btn{ border:1px solid var(--line); background:#fff; color:#4a4428; }
+    .contact-actions .btn:disabled{ opacity:0.55; cursor:not-allowed; }
+
+    .contact-settings details{
+      margin-top:16px; border:1px solid var(--line); border-radius:12px;
+      background:#fff; padding:12px 14px;
+    }
+    .contact-settings summary{ font-weight:800; cursor:pointer; }
+    .contact-settings .grid2{ display:grid; gap:12px; margin-top:10px; }
+    @media (min-width:720px){ .contact-settings .grid2{ grid-template-columns:1fr 1fr; } }
+    .contact-settings input[type="number"]{
+      width:100%; padding:8px 10px; border-radius:8px; border:1px solid var(--line);
+      background:#fff; font-family:ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
+    }
+
+    .contact-progress{ margin-top:18px; }
+    .contact-progress-label{ font-weight:700; color:#7a7557; margin-bottom:6px; }
+    .progress{ height:10px; background:#f1e7c2; border-radius:999px; overflow:hidden; }
+    .bar{ height:100%; width:0%; background:var(--green); transition:width .2s ease; }
+    .contact-status{ margin-top:6px; font-size:13px; color:#7a7557; }
+
+    .contact-debug{
+      margin-top:16px; padding:12px; border:1px dashed var(--line);
+      background:rgba(255,255,255,0.85); border-radius:12px; font-size:13px;
+      white-space:pre-wrap; color:#4a4428;
+    }
+
+    .contact-results .hint{ margin-top:0; }
+    .stat-grid{ display:grid; gap:16px; margin-top:12px; }
+    @media (min-width:980px){ .stat-grid{ grid-template-columns:repeat(2, minmax(0,1fr)); } }
+    .stat-panel{
+      border:1px solid var(--line); border-radius:12px; background:#fff;
+      padding:16px; box-shadow:0 1px 2px rgba(0,0,0,.05);
+    }
+    .stat-panel h3{ margin:0 0 10px; font-size:16px; font-weight:800; color:#5b5534; }
+
+    .contact-table{
+      width:100%; border-collapse:separate; border-spacing:0;
+      border:1px solid var(--line); border-radius:12px; overflow:hidden;
+      background:#fffdf5;
+    }
+    .contact-table thead th{
+      background:#f6f1d9; color:#5b5534; padding:10px;
+      text-align:left; font-weight:800; border-bottom:1px solid var(--line);
+    }
+    .contact-table tbody td{ padding:10px; border-top:1px solid var(--line); }
+    .contact-table tbody tr:nth-child(even){ background:#fffef9; }
+
+    .pill{
+      display:inline-block; padding:2px 10px; border-radius:999px;
+      background:#fff; border:1px solid var(--line); font-size:13px; font-weight:700; color:#4a4428;
+    }
+    .right{ text-align:right; }
+
+    .contact-notes details{ border:1px solid var(--line); border-radius:12px; background:#fff; padding:12px 16px; }
+    .contact-notes summary{ font-weight:800; cursor:pointer; }
+    .contact-notes ul{ margin:6px 0 10px 1.2em; padding:0; }
+    .contact-notes li{ margin:4px 0; }
   </style>
 
   <!-- 多版本 pdf.js 逐版回退（4.x → 3.x → 2.x；worker 失敗時同執行緒） -->
   <script>
     let __pdfReady = null, __pdfVersionUsed = null;
     async function loadScript(src){
       await new Promise((res,rej)=>{const s=document.createElement('script');s.src=src;s.onload=res;s.onerror=()=>rej(new Error('load fail '+src));document.head.appendChild(s);});
     }
     async function tryLoadPdfjs(ver){
       if (window.pdfjsLib) delete window.pdfjsLib;
       await loadScript(`https://cdn.jsdelivr.net/npm/pdfjs-dist@${ver}/build/pdf.min.js`);
       __pdfVersionUsed = ver;
       try{
         pdfjsLib.GlobalWorkerOptions.workerSrc = `https://cdn.jsdelivr.net/npm/pdfjs-dist@${ver}/build/pdf.worker.min.js`;
         await pdfjsLib.getDocument({ data: new Uint8Array([0x25,0x50,0x44,0x46,0x2D]) }).promise.catch(()=>null);
       }catch(_){
         pdfjsLib.GlobalWorkerOptions.workerSrc = "";
         pdfjsLib.GlobalWorkerOptions.workerPort = null;
       }
     }
     async function ensurePdfjs(){
       if (__pdfReady){ await __pdfReady; return; }
       __pdfReady = (async ()=>{
         const cand = ["4.2.67","3.11.174","2.16.105"];
         let ok=false,lastErr=null;
         for (const v of cand){
           try{ await tryLoadPdfjs(v); ok=true; break; }catch(e){ lastErr=e; }
         }
         if(!ok) throw lastErr || new Error("pdf.js load failed");
       })();
       await __pdfReady;
     }
   </script>
 
   <!-- Tesseract OCR（chi_tra+eng） -->
   <script>
     let __ocrReady = null;
     async function ensureTesseract(){
       if (__ocrReady){ await __ocrReady; return; }
       __ocrReady = (async ()=>{
         if(!window.Tesseract){
           await new Promise((res,rej)=>{const s=document.createElement('script');s.src='https://cdn.jsdelivr.net/npm/tesseract.js@4.0.2/dist/tesseract.min.js';s.onload=res;s.onerror=rej;document.head.appendChild(s);});
         }
         Tesseract.setLogging(false);
       })();
       await __ocrReady;
     }
   </script>
 </head>
 <body>
-  <div class="wrap">
-    <h1>PDF 支數自動統計（AA 金額換算）</h1>
-    <p class="muted">上傳報表後自動統計 <span class="pill">BA</span> / <span class="pill">AA</span> / <span class="pill">GA</span> / <span class="pill">SC</span>。
-      <span class="hint">AA 以「金額 ÷ 單價」換算支數（四捨五入到最接近 0.5）；BA/GA/SC 讀「補助/自費」後的整數。</span></p>
-
-    <div class="card row">
-      <div>
-        <label class="drop" id="drop">
+  <div class="watermark" aria-hidden="true">
+    <span class="wm-item" style="top:5%; left:5%;  --dur:9s;">@hori版權所有</span>
+    <span class="wm-item" style="top:5%; left:35%; --dur:11s;">@hori版權所有</span>
+    <span class="wm-item" style="top:5%; left:65%; --dur:10s;">@hori版權所有</span>
+
+    <span class="wm-item" style="top:25%; left:10%; --dur:13s;">@hori版權所有</span>
+    <span class="wm-item" style="top:25%; left:40%; --dur:12s;">@hori版權所有</span>
+    <span class="wm-item" style="top:25%; left:70%; --dur:14s;">@hori版權所有</span>
+
+    <span class="wm-item" style="top:50%; left:5%;  --dur:10s;">@hori版權所有</span>
+    <span class="wm-item" style="top:50%; left:35%; --dur:11s;">@hori版權所有</span>
+    <span class="wm-item" style="top:50%; left:65%; --dur:9s;">@hori版權所有</span>
+
+    <span class="wm-item" style="top:75%; left:10%; --dur:13s;">@hori版權所有</span>
+    <span class="wm-item" style="top:75%; left:40%; --dur:12s;">@hori版權所有</span>
+    <span class="wm-item" style="top:75%; left:70%; --dur:10s;">@hori版權所有</span>
+
+    <span class="wm-item" style="top:90%; left:15%; --dur:11s;">@hori版權所有</span>
+    <span class="wm-item" style="top:90%; left:45%; --dur:10s;">@hori版權所有</span>
+    <span class="wm-item" style="top:90%; left:75%; --dur:12s;">@hori版權所有</span>
+  </div>
+
+  <header id="appTopbar" class="topbar">
+    <div class="brand">
+      <a href="https://github.com/hori07/longterm-care-calculator/tree/main" target="_blank" class="logo-link">
+        <img src="org-logo.png" alt="logo" onerror="this.style.opacity=0.2" />
+      </a>
+      <span class="site-title">PDF 支數統計</span>
+    </div>
+
+    <nav class="nav-links" id="topNav">
+      <div class="nav-track">
+        <a href="index.html">額度計算機</a>
+        <a href="payroll.html">薪資計算機</a>
+        <a href="care-info.html">長照相關資訊</a>
+        <a href="news.html">最新公告</a>
+        <a href="contact.html">PDF 支數統計</a>
+        <a href="about.html">關於我們</a>
+      </div>
+    </nav>
+
+    <div class="actions actions-ghost">
+      <button class="btn pill btn-orange" type="button">B單位</button>
+      <button class="btn pill btn-green" type="button">重置</button>
+      <button class="btn pill btn-gray" type="button">列印</button>
+    </div>
+  </header>
+
+  <div class="divider"></div>
+
+  <main class="container contact-container">
+    <section class="card contact-intro">
+      <h1 class="card-title" style="font-size:22px;">PDF 支數自動統計（AA 金額換算）</h1>
+      <p class="hint">上傳月報表即可統計 <span class="tag">BA</span> / <span class="tag">AA</span> / <span class="tag">GA</span> / <span class="tag">SC</span>。AA 依金額 ÷ 單價換算並量化為 0.5 倍數，若為掃描影像將自動啟用 OCR。</p>
+      <div class="tag-list">
+        <span class="tag">支援多版本 pdf.js</span>
+        <span class="tag">自動偵測 OCR</span>
+        <span class="tag">CSV / JSON 匯出</span>
+      </div>
+    </section>
+
+    <section class="contact-grid">
+      <div class="card contact-upload">
+        <h2 class="card-title">上傳與設定</h2>
+        <label class="contact-drop" id="drop">
           <input type="file" id="file" accept="application/pdf" />
           <strong>點我選擇 PDF 或拖曳到這裡</strong>
-          <div class="small muted">建議 1～10 頁；掃描影像會自動走 OCR。</div>
+          <div class="hint" style="margin-top:6px;">建議 1～10 頁；掃描影像會自動啟用 OCR。</div>
         </label>
 
-        <div style="margin-top:8px;display:flex;gap:8px;flex-wrap:wrap">
-          <button class="btn" id="demo">載入示範資料</button>
-          <button class="btn" id="csv" disabled>匯出 CSV</button>
-          <button class="btn" id="json" disabled>匯出 JSON</button>
+        <div class="contact-actions">
+          <button class="btn pill btn-green" id="demo" type="button">載入示範資料</button>
+          <button class="btn pill btn-orange" id="csv" type="button" disabled>匯出 CSV</button>
+          <button class="btn pill btn-gray" id="json" type="button" disabled>匯出 JSON</button>
         </div>
 
-        <div class="card small" style="margin-top:12px">
+        <div class="contact-settings">
           <details open>
             <summary>AA 單價設定（元/支）</summary>
             <div class="grid2">
-              <label>AA05<br><input class="mono" id="p-AA05" type="number" value="200" style="width:100%;padding:8px;border-radius:8px;border:1px solid #d7deea;"></label>
-              <label>AA06<br><input class="mono" id="p-AA06" type="number" value="200" style="width:100%;padding:8px;border-radius:8px;border:1px solid #d7deea;"></label>
-              <label>AA09<br><input class="mono" id="p-AA09" type="number" value="770" style="width:100%;padding:8px;border-radius:8px;border:1px solid #d7deea;"></label>
-              <label>AA11<br><input class="mono" id="p-AA11" type="number" value="50"  style="width:100%;padding:8px;border-radius:8px;border:1px solid #d7deea;"></label>
+              <label>AA05<br><input id="p-AA05" type="number" value="200"></label>
+              <label>AA06<br><input id="p-AA06" type="number" value="200"></label>
+              <label>AA09<br><input id="p-AA09" type="number" value="770"></label>
+              <label>AA11<br><input id="p-AA11" type="number" value="50"></label>
             </div>
           </details>
         </div>
 
-        <div class="card" style="margin-top:12px">
-          <div class="small muted">處理進度</div>
+        <div class="contact-progress">
+          <div class="contact-progress-label">處理進度</div>
           <div class="progress"><div id="bar" class="bar"></div></div>
-          <div id="status" class="small muted" style="margin-top:6px">待上傳</div>
+          <div id="status" class="contact-status">待上傳</div>
         </div>
 
-        <div id="debug" class="small">偵錯訊息：</div>
+        <div id="debug" class="contact-debug">偵錯訊息：</div>
       </div>
 
-      <div>
-        <div class="card">
-          <div class="small muted">分析結果</div>
-          <h3>BA 統計</h3>
-          <table id="t-BA">
-            <thead><tr><th>碼別</th><th class="right">出現筆數</th><th class="right">Σ 支數</th></tr></thead>
-            <tbody></tbody>
-          </table>
-        </div>
-        <div class="card">
-          <h3>AA 統計</h3>
-          <table id="t-AA">
-            <thead><tr><th>碼別</th><th class="right">出現筆數</th><th class="right">Σ 支數</th></tr></thead>
-            <tbody></tbody>
-          </table>
-        </div>
-        <div class="card">
-          <h3>GA 統計</h3>
-          <table id="t-GA">
-            <thead><tr><th>碼別</th><th class="right">出現筆數</th><th class="right">Σ 支數</th></tr></thead>
-            <tbody></tbody>
-          </table>
-        </div>
-        <div class="card">
-          <h3>SC 統計</h3>
-          <table id="t-SC">
-            <thead><tr><th>碼別</th><th class="right">出現筆數</th><th class="right">Σ 支數</th></tr></thead>
-            <tbody></tbody>
-          </table>
+      <div class="card contact-results">
+        <h2 class="card-title">統計結果</h2>
+        <p class="hint">依碼別列出出現筆數與 Σ 支數，AA 以單價換算後四捨五入到最接近 0.5。</p>
+
+        <div class="stat-grid">
+          <div class="stat-panel">
+            <h3>BA 統計</h3>
+            <table id="t-BA" class="contact-table">
+              <thead><tr><th>碼別</th><th class="right">出現筆數</th><th class="right">Σ 支數</th></tr></thead>
+              <tbody></tbody>
+            </table>
+          </div>
+          <div class="stat-panel">
+            <h3>AA 統計</h3>
+            <table id="t-AA" class="contact-table">
+              <thead><tr><th>碼別</th><th class="right">出現筆數</th><th class="right">Σ 支數</th></tr></thead>
+              <tbody></tbody>
+            </table>
+          </div>
+          <div class="stat-panel">
+            <h3>GA 統計</h3>
+            <table id="t-GA" class="contact-table">
+              <thead><tr><th>碼別</th><th class="right">出現筆數</th><th class="right">Σ 支數</th></tr></thead>
+              <tbody></tbody>
+            </table>
+          </div>
+          <div class="stat-panel">
+            <h3>SC 統計</h3>
+            <table id="t-SC" class="contact-table">
+              <thead><tr><th>碼別</th><th class="right">出現筆數</th><th class="right">Σ 支數</th></tr></thead>
+              <tbody></tbody>
+            </table>
+          </div>
         </div>
       </div>
-    </div>
+    </section>
 
-    <div class="card small">
+    <section class="card contact-notes">
       <details>
         <summary>解析規則摘要</summary>
         <ul>
           <li>代碼：<code>(BA|AA|GA|SC)\d{2}(?:-\d+)?</code></li>
-          <li>BA/GA/SC：支數＝行內「補助 / 自費」後的整數（1–20）。</li>
-          <li>AA：支數＝（AA 碼之後最近的金額 ÷ 單價），並**量化為 0.5 的倍數**。</li>
-          <li>若 PDF 無文字層，改以 OCR 逐頁辨識後再統計。</li>
+          <li>BA / GA / SC：支數＝行內「補助 / 自費」後的整數（1–20）。</li>
+          <li>AA：支數＝（AA 碼之後最近的金額 ÷ 單價），並<strong>量化為 0.5 的倍數</strong>。</li>
+          <li>若 PDF 無文字層，會改以 OCR 逐頁辨識後再統計。</li>
         </ul>
       </details>
-    </div>
-  </div>
+    </section>
+  </main>
 
   <script>
   (function(){
     const $ = s => document.querySelector(s);
     const debug = $('#debug'), bar = $('#bar'), statusEl = $('#status');
     function log(s){ debug.textContent += (typeof s==='string'?s:JSON.stringify(s,null,2)) + '\n'; console.log('[pdf-stat]', s); }
     function whyStr(e){ return (e && (e.message || e.reason || e.type || e.name)) || String(e); }
     function setBar(p){ bar.style.width = Math.max(0, Math.min(100, p)) + '%'; }
 
     const fileInput = $('#file');
     const drop = $('#drop');
     const btnDemo = $('#demo');
     const btnCSV = $('#csv');
     const btnJSON = $('#json');
 
     const tBodies = {
       BA: $('#t-BA tbody'),
       AA: $('#t-AA tbody'),
       GA: $('#t-GA tbody'),
       SC: $('#t-SC tbody'),
     };
 
     function getAAUnit(){
       return {
         AA05: Number($('#p-AA05').value || 200),
@@ -206,51 +345,51 @@
       const ab = await file.arrayBuffer();
       const blob = new Blob([ab], {type:'application/pdf'});
       const url = URL.createObjectURL(blob);
 
       const ways = [
         {kind:'data', opts:{data: ab}},
         {kind:'url',  opts:{url}}
       ];
 
       let lastErr=null;
       for (const way of ways){
         try{
           const pdf = await pdfjsLib.getDocument(way.opts).promise;
           let texts = [], total = 0;
           for(let i=1;i<=pdf.numPages;i++){
             const page = await pdf.getPage(i);
             const content = await page.getTextContent({ normalizeWhitespace:true, disableCombineTextItems:false });
             const s = content.items.map(it=>it.str||'').join(' ');
             total += s.length; texts.push(s);
             setBar(100 * i / pdf.numPages);
             statusEl.textContent = `PDF 解析中 (${i}/${pdf.numPages}) · pdf.js ${__pdfVersionUsed} · ${way.kind}`;
           }
           URL.revokeObjectURL(url);
           log(`PDF.js 解析（${way.kind}）：頁數 ${pdf.numPages}，總字元 ${total} · 版本 ${__pdfVersionUsed}`);
           if (pdf.numPages>0) log(`預覽：${texts[0].slice(0,200).replace(/\s+/g,' ')}`);
-          return { text: texts.join('\n'), charCount: total, pages: pdf.numPages, pdf };
+          return { text: texts.join('\n'), charCount: total, pdf };
         }catch(e){
           lastErr=e; log(`PDF.js 方式「${way.kind}」失敗：`+whyStr(e));
         }
       }
       throw lastErr || new Error('pdf.js all ways failed');
     }
 
     // OCR：pdf 每頁轉 Canvas → Tesseract
     async function ocrPdfToText(pdf){
       await ensureTesseract();
       const worker = await Tesseract.createWorker('chi_tra+eng');
       try{
         let all = [];
         const total = pdf.numPages;
         for(let i=1;i<=total;i++){
           const page = await pdf.getPage(i);
           const viewport = page.getViewport({ scale: 2.0 });
           const canvas = document.createElement('canvas');
           const ctx = canvas.getContext('2d', { willReadFrequently:true });
           canvas.width = viewport.width; canvas.height = viewport.height;
           await page.render({ canvasContext: ctx, viewport }).promise;
 
           statusEl.textContent = `OCR 執行中（第 ${i}/${total} 頁）…`;
           setBar(100 * (i-1) / total);
           const res = await worker.recognize(canvas, { rectangle: null });
@@ -319,53 +458,53 @@
             if (cMatch){
               const v = parseInt(cMatch[1],10);
               if (v >= 1 && v <= 20) zhi = v;
             }
           }
 
           const rec = store[fullCode] || {occ:0,sum:0};
           rec.occ += 1;
           rec.sum += zhi;
           store[fullCode] = rec;
         }
       }
 
       const rows = obj => Object.entries(obj)
         .map(([code,{occ,sum}]) => ({code, occ, sum}))
         .sort((a,b)=>a.code.localeCompare(b.code));
 
       return { BA: rows(fam.BA), AA: rows(fam.AA), GA: rows(fam.GA), SC: rows(fam.SC) };
     }
 
     // 渲染（三欄）
     function renderRows(tbody, rows){
       tbody.innerHTML = '';
       for(const r of rows){
         const tr = document.createElement('tr');
-        tr.innerHTML = `<td><span class="pill">${r.code}</span></td>
-                        <td class="right">${r.occ}</td>
-                        <td class="right">${r.sum.toFixed(3)}</td>`;
+        tr.innerHTML = `<td><span class="pill">${r.code}</span></td>`+
+                        `<td class="right">${r.occ}</td>`+
+                        `<td class="right">${r.sum.toFixed(3)}</td>`;
         tbody.appendChild(tr);
       }
     }
     function renderAll(res){
       renderRows(tBodies.BA, res.BA);
       renderRows(tBodies.AA, res.AA);
       renderRows(tBodies.GA, res.GA);
       renderRows(tBodies.SC, res.SC);
     }
 
     // 匯出
     function exportCSV(res){
       const blk=(title,rows)=>`${title}\n碼別,出現筆數,Σ支數\n`+rows.map(r=>`${r.code},${r.occ},${r.sum.toFixed(3)}`).join('\n')+'\n\n';
       const csv= blk('【BA 統計】',res.BA)+blk('【AA 統計】',res.AA)+blk('【GA 統計】',res.GA)+blk('【SC 統計】',res.SC);
       const blob=new Blob([csv],{type:'text/csv;charset=utf-8'}); const url=URL.createObjectURL(blob);
       const a=document.createElement('a'); a.href=url; a.download='pdf-stat.csv'; a.click(); URL.revokeObjectURL(url);
     }
     function exportJSON(res){
       const pick = rows => rows.map(r=>({code:r.code,occ:r.occ,sum:Number(r.sum.toFixed(3))}));
       const payload = { BA: pick(res.BA), AA: pick(res.AA), GA: pick(res.GA), SC: pick(res.SC), meta:{generatedAt:new Date().toISOString()} };
       const blob=new Blob([JSON.stringify(payload,null,2)],{type:'application/json'}); const url=URL.createObjectURL(blob);
       const a=document.createElement('a'); a.href=url; a.download='pdf-stat.json'; a.click(); URL.revokeObjectURL(url);
     }
 
     let last=null;
@@ -394,117 +533,58 @@
               const url = URL.createObjectURL(new Blob([ab],{type:'application/pdf'}));
               pdfObj = await pdfjsLib.getDocument({url}).promise;
               URL.revokeObjectURL(url);
             }
           }catch(e){
             log('pdf 物件建立失敗：'+whyStr(e));
             alert('此 PDF 無法解析（可能損壞/受保護）。可先用 Google 雲端硬碟「以 Google 文件開啟」另存後重試。');
             return;
           }
         }
         statusEl.textContent='未偵測到文字，啟用 OCR…（首次可能較久）';
         setBar(1);
         text = await ocrPdfToText(pdfObj);
         setBar(100); statusEl.textContent='OCR 完成';
       }
 
       if (!text.trim()){ alert('沒有擷取到內容。'); return; }
       const res = analyze(text);
       renderAll(res);
       last = res;
       btnCSV.disabled = btnJSON.disabled = false;
     }
 
     // 綁定
     fileInput.addEventListener('change', e=>{ const f=e.target.files && e.target.files[0]; if(f) handleFile(f); });
-    ['dragenter','dragover'].forEach(ev=>drop.addEventListener(ev, e=>{e.preventDefault(); drop.style.background='#eef4ff';}));
-    ['dragleave','drop'].forEach(ev=>drop.addEventListener(ev, e=>{e.preventDefault(); drop.style.background='#f9fbff';}));
+    ['dragenter','dragover'].forEach(ev=>drop.addEventListener(ev, e=>{e.preventDefault(); drop.style.background='#fff9ec'; drop.style.borderColor='#f1d48f';}));
+    ['dragleave','drop'].forEach(ev=>drop.addEventListener(ev, e=>{e.preventDefault(); drop.style.background='#fffef9'; drop.style.borderColor='#d6cfae';}));
     drop.addEventListener('drop', e=>{
       e.preventDefault();
       const f = e.dataTransfer.files && e.dataTransfer.files[0];
       if(f) handleFile(f);
     });
 
     btnCSV.addEventListener('click', ()=> last && exportCSV(last));
     btnJSON.addEventListener('click', ()=> last && exportJSON(last));
 
     // 示範資料（AA 金額換算；BA/GA/SC 以次數）
     btnDemo.addEventListener('click', ()=>{
       const demo = `嚴雅雯 賴美女 2025/09/01 AA05 補助 $100
 嚴雅雯 賴美女 2025/09/02 AA05 補助 $200
 嚴雅雯 張財進 2025/09/02 AA06 自費 $200
 嚴雅雯 賴美女 2025/09/06 AA09 補助 $770
 嚴雅雯 江昭輝 2025/09/01 AA11 補助 $50
 嚴雅雯 范秉殷 2025-09-05 BA01 補助 1 $260
 嚴雅雯 江昭輝 2025-09-01 BA07 補助 1 $325
 嚴雅雯 張財進 2025-09-02 BA11 自費 2 $195
 嚴雅雯 李OO   2025-09-03 GA05 補助 3
 嚴雅雯 王OO   2025-09-04 SC02 自費 1`;
       const res = analyze(demo);
       renderAll(res);
       last = res;
       btnCSV.disabled = btnJSON.disabled = false;
       setBar(100); statusEl.textContent = '示範資料已載入';
     });
   })();
   </script>
-  <!-- ① 依實際高度更新 --topbar-h，讓 sticky 表頭與錨點不被擋到 -->
-<script>
-(function setTopbarH(){
-  const tb = document.getElementById('appTopbar') || document.querySelector('.topbar');
-  if(!tb) return;
-  const apply = () => {
-    const h = Math.round(tb.getBoundingClientRect().height);
-    document.documentElement.style.setProperty('--topbar-h', h + 'px');
-  };
-  window.addEventListener('load', apply);
-  window.addEventListener('resize', apply);
-  // 圖檔載入或字型換行後再補一次
-  let raf; new ResizeObserver(()=>{ cancelAnimationFrame(raf); raf=requestAnimationFrame(apply); }).observe(tb);
-  setTimeout(apply, 0);
-})();
-</script>
-
-<!-- ② 導覽超出寬度時啟用「軌道可橫向滑動」並確保能滑回最左邊 -->
-<script>
-(function navOverflowFix(){
-  const nav = document.getElementById('topNav');
-  if(!nav) return;
-  const track = nav.querySelector('.nav-track') || nav.firstElementChild || nav;
-
-  function update(){
-    const overflow = track.scrollWidth > nav.clientWidth + 1;
-    // 讓 .nav-links 本身就可以橫滑（你已在 CSS 設了 overflow-x:auto；這裡只做狀態判斷）
-    nav.classList.toggle('is-overflow', overflow);
-    if (overflow && track.scrollLeft < 0) track.scrollLeft = 0;
-  }
-
-  // 滑鼠滾輪自動轉成水平滾動（保證能滑回最左邊）
-  track.addEventListener('wheel', (e) => {
-    if (Math.abs(e.deltaY) > Math.abs(e.deltaX)) {
-      track.scrollLeft += e.deltaY;
-      e.preventDefault();
-    }
-  }, { passive:false });
-
-  // 拖曳滾動（滑鼠按住拖移）
-  let isDown=false, startX=0, startLeft=0;
-  track.addEventListener('mousedown', e=>{ isDown=true; startX=e.pageX; startLeft=track.scrollLeft; track.style.cursor='grabbing'; });
-  track.addEventListener('mouseleave', ()=>{ isDown=false; track.style.cursor=''; });
-  track.addEventListener('mouseup', ()=>{ isDown=false; track.style.cursor=''; });
-  track.addEventListener('mousemove', e=>{
-    if(!isDown) return;
-    const dx = e.pageX - startX;
-    track.scrollLeft = startLeft - dx;
-  });
-
-  // 初始與後續檢查（視窗改變、字型/圖片造成寬度改變）
-  const check = () => requestAnimationFrame(update);
-  window.addEventListener('load', check);
-  window.addEventListener('resize', check);
-  new MutationObserver(check).observe(track, { childList:true, subtree:true, characterData:true });
-  new ResizeObserver(check).observe(track);
-  check();
-})();
-</script>
 </body>
 </html>
 
EOF
)
