<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>長照相關資訊｜補助額度速覽</title>

  <link rel="icon" type="image/x-icon" href="YORU.ico" />
  <link rel="stylesheet" href="style.css" />
  <!-- 加版本參數，避免舊快取沒更新 -->
  <script src="script.js?v=20251104-qa1" defer></script>

  <!-- 浮水印（與首頁一致） -->
  <style>
    :root{
      --wm-text: "@hori版權所有";
      --wm-size: 36px;
      --wm-angle: -25deg;
      --wm-alpha: 0.05;
      --wm-shift: 120px;
    }
    .watermark { position: fixed; inset: 0; pointer-events: none; z-index: 9999; overflow: hidden; }
    .topbar { z-index: 10000; position: sticky; top: 0; }
    .wm-item{
      position: absolute;
      font-weight: 700;
      font-size: var(--wm-size);
      color: rgba(0,0,0,var(--wm-alpha));
      transform: rotate(var(--wm-angle));
      white-space: nowrap;
      user-select: none;
      will-change: transform;
      animation: wm-sway var(--dur, 12s) ease-in-out infinite alternate;
    }
    @keyframes wm-sway{
      0%   { transform: translateX(0) rotate(var(--wm-angle)); }
      100% { transform: translateX(var(--wm-shift)) rotate(var(--wm-angle)); }
    }
    @media print{ .watermark { opacity: 0.08; } }

    /* 額度速覽表格（內嵌，確保本頁一定有） */
    .info-table {
      width: 100%;
      border-collapse: separate;
      border-spacing: 0;
      background: var(--card);
      border: 1px solid var(--line);
      border-radius: 12px;
      overflow: hidden;
      text-align: center;
      margin-top: 10px;
    }
    .info-table th {
      background: #f6f1d9;
      color: #5b5534;
      padding: 10px;
      font-weight: 800;
      border-bottom: 1px solid var(--line);
    }
    .info-table td {
      padding: 10px;
      border-top: 1px solid var(--line);
      font-weight: 600;
    }
    .info-table tbody tr:nth-child(even) { background: #fffef9; }

    /* 頁面自己的快捷按鈕樣式（沿用你全站風格） */
    .quick-links{ display:flex; gap:10px; flex-wrap:wrap; margin:14px 0 8px; }
    .quick-links a{
      display:inline-block; padding:8px 14px; border-radius:999px;
      background:#fff; border:1px solid var(--line); font-weight:700; color:#333; text-decoration:none;
    }
    .quick-links a:hover{ filter:brightness(1.02); transform:translateY(-1px); }
  </style>
</head>

<body>
  <!-- 浮水印 -->
  <div class="watermark" aria-hidden="true">
    <span class="wm-item" style="top:5%; left:5%; --dur:9s;">@hori版權所有</span>
    <span class="wm-item" style="top:5%; left:35%; --dur:11s;">@hori版權所有</span>
    <span class="wm-item" style="top:5%; left:65%; --dur:10s;">@hori版權所有</span>
    <span class="wm-item" style="top:25%; left:10%; --dur:13s;">@hori版權所有</span>
    <span class="wm-item" style="top:25%; left:40%; --dur:12s;">@hori版權所有</span>
    <span class="wm-item" style="top:25%; left:70%; --dur:14s;">@hori版權所有</span>
    <span class="wm-item" style="top:50%; left:5%; --dur:10s;">@hori版權所有</span>
    <span class="wm-item" style="top:50%; left:35%; --dur:11s;">@hori版權所有</span>
    <span class="wm-item" style="top:50%; left:65%; --dur:9s;">@hori版權所有</span>
    <span class="wm-item" style="top:75%; left:10%; --dur:13s;">@hori版權所有</span>
    <span class="wm-item" style="top:75%; left:40%; --dur:12s;">@hori版權所有</span>
    <span class="wm-item" style="top:75%; left:70%; --dur:10s;">@hori版權所有</span>
    <span class="wm-item" style="top:90%; left:15%; --dur:11s;">@hori版權所有</span>
    <span class="wm-item" style="top:90%; left:45%; --dur:10s;">@hori版權所有</span>
    <span class="wm-item" style="top:90%; left:75%; --dur:12s;">@hori版權所有</span>
  </div>

  <!-- 頂部導覽列 -->
  <header class="topbar">
    <div class="brand">
      <a href="https://github.com/hori07/longterm-care-calculator/tree/main" target="_blank" class="logo-link">
        <img src="org-logo.png" alt="logo" onerror="this.style.opacity=0.2" />
      </a>
      <span class="site-title">長照相關資訊</span>
    </div>

    <nav class="nav-links">
      <a href="index.html">首頁</a>
      <a href="care-info.html">長照相關資訊</a>
      <a href="news.html">最新公告</a>
      <a href="contact.html">聯繫方式</a>
      <a href="about.html">關於我們</a>
    </nav>

    <div class="actions">
      <button class="btn pill btn-orange" id="btnUnitToggle" type="button" data-unit="B">B單位</button>
      <button class="btn pill btn-green" id="btnReset" type="button">重置</button>
      <button class="btn pill btn-gray" type="button" onclick="window.print()">列印</button>
    </div>
  </header>

  <div class="divider"></div>

  <main class="container">
    <!-- 頁首區（保留你原本的樣式與文案邏輯） -->
    <section class="card" style="margin-bottom:16px;">
      <h1 class="card-title" style="font-size:22px;">長照相關資訊</h1>
      <p class="hint">彙整法規重點、補助額度、常用碼別與下載連結。</p>

      <!-- 快捷導覽（保留你原來的 5 顆） -->
      <div class="quick-links">
        <a href="#laws">法規與作業要點</a>
        <a href="#quota-ba">補助額度速覽</a>
        <a href="#codes">常用碼別備忘</a>
        <a href="#forms">表單與下載</a>
        <a href="#faq">常見問題</a>
      </div>
    </section>

    <!-- ======= BA 額度 ======= -->
    <section id="quota-ba" class="card">
      <h2 class="card-title">補助額度速覽（BA 碼）</h2>
      <p class="hint">依 CMS 等級之每月給付額（政府補助比例：一般戶 84%、中低收 95%、低收 100%）。</p>
      <table class="info-table" id="baQuotaTable">
        <thead>
          <tr>
            <th>CMS 等級</th>
            <th>一般戶(84%)</th>
            <th>中低收(95%)</th>
            <th>低收(100%)</th>
            <th>基礎額度</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </section>

    <!-- ======= GA 額度 ======= -->
    <section class="card">
      <h2 class="card-title">補助額度速覽（GA 碼｜喘息服務）</h2>
      <p class="hint">依 CMS 等級之每月最高補助額度。</p>
      <table class="info-table" id="gaQuotaTable">
        <thead>
          <tr>
            <th>CMS 等級</th>
            <th>GA 額度</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </section>

    <!-- ======= SC 額度 ======= -->
    <section class="card">
      <h2 class="card-title">補助額度速覽（SC 碼｜居家短照服務）</h2>
      <p class="hint">依 CMS 等級之每月最高補助額度。</p>
      <table class="info-table" id="scQuotaTable">
        <thead>
          <tr>
            <th>CMS 等級</th>
            <th>SC 額度</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </section>

    <!-- 其它區塊（保留你的原有區位，先放占位，之後要我填內容再說） -->
    <section id="laws" class="card">
      <h2 class="card-title">法規與作業要點</h2>
      <p class="hint">（放各部會連結、作業要點重點條列…）</p>
    </section>

    <section id="codes" class="card">
      <h2 class="card-title">常用碼別備忘</h2>
      <p class="hint">（可列 BA/BD/C/GA/SC 常見項目摘要與注意事項）</p>
    </section>

    <section id="forms" class="card">
      <h2 class="card-title">表單與下載</h2>
      <p class="hint">（放申請表、同意書、評估表等檔案下載連結）</p>
    </section>

    <section id="faq" class="card">
      <h2 class="card-title">常見問題</h2>
      <p class="hint">（整理家屬與居服常問 Q&A）</p>
    </section>
  </main>

  <footer id="bottomDock" class="footerbar">
    <div class="foot">
      <span class="ok">本頁為補助速覽，實際金額以額度試算機計算結果為準。</span>
    </div>
  </footer>

  <!-- ====== 安全渲染：等待全域變數可用，再產表（最多等 1 秒） ====== -->
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const fmt = n => Number(n || 0).toLocaleString('zh-TW');
      const levels = [2,3,4,5,6,7,8];

      function ready() {
        return (typeof cmsQuota === 'object') && (typeof GA_CAP === 'object') && (typeof SC_CAP === 'object');
      }

      function render() {
        // BA
        const baTbody = document.querySelector('#baQuotaTable tbody');
        baTbody.innerHTML = '';
        levels.forEach(cms => {
          const base = cmsQuota[cms] || 0;
          const tr = document.createElement('tr');
          tr.innerHTML = `
            <td>CMS${cms}</td>
            <td>${fmt(Math.round(base * 0.84))}</td>
            <td>${fmt(Math.round(base * 0.95))}</td>
            <td>${fmt(base)}</td>
            <td>${fmt(base)}</td>
          `;
          baTbody.appendChild(tr);
        });

        // GA
        const gaTbody = document.querySelector('#gaQuotaTable tbody');
        gaTbody.innerHTML = '';
        levels.forEach(cms => {
          const val = GA_CAP[cms] || 0;
          const tr = document.createElement('tr');
          tr.innerHTML = `<td>CMS${cms}</td><td>${fmt(val)}</td>`;
          gaTbody.appendChild(tr);
        });

        // SC
        const scTbody = document.querySelector('#scQuotaTable tbody');
        scTbody.innerHTML = '';
        levels.forEach(cms => {
          const val = SC_CAP[cms] || 0;
          const tr = document.createElement('tr');
          tr.innerHTML = `<td>CMS${cms}</td><td>${fmt(val)}</td>`;
          scTbody.appendChild(tr);
        });
      }

      // 最多等 1 秒以防雲端延遲／快取
      let waited = 0;
      const t = setInterval(() => {
        if (ready() || waited >= 1000) {
          clearInterval(t);
          render();
        }
        waited += 50;
      }, 50);
    });
  </script>

  <!-- 導覽目前頁高亮（與全站一致邏輯） -->
  <script>
    (function(){
      function normalize(href){
        try{
          const u = new URL(href, location.origin);
          let p = u.pathname.trim();
          if (p.length > 1 && p.endsWith('/')) p = p.slice(0, -1);
          p = p.replace(/\/(index\.html?)?$/i, '/index').replace(/\.html?$/i, '');
          const parts = p.split('/'); return (parts[parts.length-1]||'').toLowerCase();
        }catch(e){ return ''; }
      }
      const here = normalize(location.href);
      document.querySelectorAll('.nav-links a[href]').forEach(a=>{
        const target = normalize(a.getAttribute('href'));
        if (target && target === here) a.classList.add('active');
      });
    })();
  </script>

  <!-- 防拷（如需關閉可移除） -->
  <script>
    document.addEventListener('contextmenu', e => e.preventDefault());
    document.addEventListener('keydown', e => {
      if ((e.ctrlKey || e.metaKey) && ['u','s','p'].includes(e.key.toLowerCase())) e.preventDefault();
      if (e.key === 'F12') e.preventDefault();
    });
    document.addEventListener('selectstart', e => e.preventDefault());
    document.addEventListener('copy', e => e.preventDefault());
  </script>
</body>
</html>
